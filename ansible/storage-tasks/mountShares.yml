---
- name: Create CIFS credentials file
  copy:
    content: |
      username={{CIFS_Username}}
      password={{CIFS_Password}}
    dest: "{{CIFS_credential_location}}"
    mode: '0600'

# - name: Mount media volume
#   ansible.posix.mount:
#     src: "//{{nas_ip}}/media"
#     path: /mnt/media
#     opts: "{{smb_options}}"
#     fstype: cifs
#     state: mounted

# - name: Mount backup volume
#   ansible.posix.mount:
#     src: "//{{nas_ip}}/backup"
#     path: /mnt/backup
#     opts: "{{smb_options}}"
#     fstype: cifs
#     state: mounted

- name: Mount proxmox ssd_storage volume
  mount:
    src: "//{{item.ip}}/{{item.name}}"
    path: "/mnt/{{item.name}}"
    opts: "{{smb_options}}"
    fstype: cifs
    state: "{{ item.state }}"
  loop: "{{ shares_mount }}"